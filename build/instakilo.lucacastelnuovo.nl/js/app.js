"use strict";function materialize_init(){
// Enable SideBar
M.Sidenav.init(document.querySelectorAll(".sidenav"),{edge:"right",draggable:1});// Add character counter to inputs
M.CharacterCounter.init(document.querySelectorAll(".counter"));// Enable MaterialBox
M.Materialbox.init(document.querySelectorAll(".materialboxed"),{})}function request(e,t,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&n(JSON.parse(a.responseText))},a.open(e,t),a.send()}function feed_render_posts(e){if(setInterval(feed_check_posts,3e4),!e.success)return!1;localStorage.setItem("posts",JSON.stringify(e));var t=[],n=!0,a=!1,s=void 0;try{for(var c,o=e.posts[Symbol.iterator]();!(n=(c=o.next()).done);n=!0)post=c.value,t.push(feed_render_post(post))}catch(e){a=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}return t.join("")}function feed_check_posts(){request("GET","https://instakilo.lucacastelnuovo.nl/posts/actions/".concat(CSRFtoken,"/feed"),function(e){JSON.stringify(e)!==localStorage.getItem("posts")&&(M.Toast.dismissAll(),M.toast({html:'<span>You have new posts!</span><button class="btn-flat toast-action blue-text accent-4" onclick="location.reload()">Load Posts</button>',displayLength:864e5}))})}function feed_render_post(e){var t,n;n=null!==e.comments&&e.comments_allowed?(t=feed_render_comments(e.comments),'\n            <form action="/posts/actions" method="POST">\n                <div class="row mb-0">\n                    <div class="col s12 m9">\n                        <div class="input-field col s12 mb-0">\n                            <label for="form_comment">Comment</label>\n                            <textarea id="form_comment" class="materialize-textarea counter" name="comment" data-length="200"></textarea>\n                        </div>\n                    </div>\n                    <div class="input-field col s12 m3">\n                        <input type="hidden" name="CSRFtoken" value="'.concat(CSRFtoken,'">\n                        <input type="hidden" name="post_id" value="').concat(e.id,'">\n\n                        <button class="btn waves-effect waves-light col s12 blue accent-4" name="action" type="submit">\n                            Send <i class="material-icons right">send</i>\n                        </button>\n                    </div>\n                </div>\n            </form>\n        ')):(t='<li class="collection-item">Comments are disabled</li>',"");var a=e.liked?"favorite":"favorite_border",s=e.liked?"undo_like":"like";return'\n        <div class="col s12">\n            <div class="card">\n                <div class="card-image"><img id="post_image" class="materialboxed" data-caption="'.concat(e.caption,'" src="').concat(e.img_url,'"></div>\n                <div class="card-content">\n                    <p>\n                        <span id="post_owner"><a href="/u/').concat(e.username,'">').concat(e.username,"</a></span> ").concat(e.caption,'\n                    </p>\n                </div>\n                <div class="card-action">\n                    <div class="row likes">\n                        <a href="/posts/actions/').concat(CSRFtoken,"/").concat(s,"/").concat(e.id,'" class="mr-6"><i class="material-icons blue-icon">').concat(a,"</i></a> ").concat(e.likes,' likes\n                    </div>\n                    <div class="row mb-0">\n                        <h6>Comments:</h6>\n                        <ul class="collection">\n                            ').concat(t,"\n                        </ul>\n                            ").concat(n,"\n                    </div>\n                </div>\n            </div>\n        </div>\n    ")}function feed_render_comments(e){var t=[],n=!0,a=!1,s=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done);n=!0)comment=c.value,t.push(feed_render_comment(comment))}catch(e){a=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}return t.join("")}function feed_render_comment(e){return'\n        <li class="collection-item avatar">\n            <img src="'.concat(e.profile_picture,'" onerror="this.src=\'https://github.com/identicons/').concat(e.username,'.png\'" class="circle" />\n            <span class="title"><a href="/u/').concat(e.username,'" class="blue-text">').concat(e.username,'</a></span>\n            <p class="truncate">').concat(e.body,"</p>\n        </li>\n    ")}function feed_render_messages(e){if(setInterval(feed_check_messages,3e4),!e.success)return'\n            <li class="collection-item avatar">\n                <i class="material-icons circle">account_circle</i> <span class="title">FirstName Last Name</span>\n                <p class="truncate">Layers, background, shot, concept – good!</p><a class="secondary-content" href="#!"><i class="material-icons blue-icon">message</i></a>\n            </li>\n        ';localStorage.setItem("messages",JSON.stringify(e));var t=[],n=!0,a=!1,s=void 0;try{for(var c,o=e.messages[Symbol.iterator]();!(n=(c=o.next()).done);n=!0)message=c.value,t.push(feed_render_message(message))}catch(e){a=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}return t.join("")}function feed_check_messages(){request("GET","https://instakilo.lucacastelnuovo.nl/messages/actions/".concat(CSRFtoken),function(e){JSON.stringify(e)!==localStorage.getItem("messages")&&(M.Toast.dismissAll(),M.toast({html:'<span>You have new messages!</span><button class="btn-flat toast-action blue-text accent-4" onclick="location.reload()">Load messages</button>',displayLength:864e5}))})}function feed_render_message(){return'\n        <li class="collection-item avatar">\n            <i class="material-icons circle">account_circle</i> <span class="title">FirstName Last Name</span>\n            <p class="truncate">Layers, background, shot, concept – good!</p><a class="secondary-content" href="#!"><i class="material-icons blue-icon">message</i></a>\n        </li>\n    '}
// @codekit-prepend "init.js";
// @codekit-prepend "request.js";
// @codekit-prepend "feed_posts.js";
// @codekit-prepend "feed_messages.js";
"undefined"!=typeof auto_init&&auto_init&&document.addEventListener("DOMContentLoaded",function(){materialize_init()});
//# sourceMappingURL=app.js.map