"use strict";function materialize_init(){
// Enable SideBar
M.Sidenav.init(document.querySelectorAll(".sidenav"),{edge:"right",draggable:1});// Add character counter to inputs
M.CharacterCounter.init(document.querySelectorAll(".counter"));// Enable MaterialBox
M.Materialbox.init(document.querySelectorAll(".materialboxed"),{})}function request(e,n,t){var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&t(JSON.parse(a.responseText))},a.open(e,n),a.send()}function feed_render_posts(e){if(setInterval(feed_check_posts(),3e3),!e.success)return console.log("no posts"),!1;localStorage.setItem("posts",e);var n=[],t=!0,a=!1,o=void 0;try{for(var s,c=e.posts[Symbol.iterator]();!(t=(s=c.next()).done);t=!0)post=s.value,n.push(feed_render_post(post))}catch(e){a=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(a)throw o}}return n.join("")}function feed_check_posts(){request("GET","https://instakilo.lucacastelnuovo.nl/posts/actions/".concat(CSRFtoken,"/feed"),function(e){e!==localStorage.getItem("posts")&&M.toast({html:'<span>You have new posts!</span><button class="btn-flat toast-action blue-text accent-4" onclick="location.reload()">Load Posts</button>',displayLength:864e5})})}function feed_render_post(e){var n,t;t=null!==e.comments&&e.comments_allowed?(n=render_comments(e.comments),'\n            <form action="/posts/actions" method="POST">\n                <div class="row mb-0">\n                    <div class="col s12 m9">\n                        <div class="input-field col s12 mb-0">\n                            <label for="form_comment">Comment</label>\n                            <textarea id="form_comment" class="materialize-textarea counter" name="comment" data-length="200"></textarea>\n                        </div>\n                    </div>\n                    <div class="input-field col s12 m3">\n                        <input type="hidden" name="CSRFtoken" value="'.concat(CSRFtoken,'">\n                        <input type="hidden" name="post_id" value="').concat(e.id,'">\n\n                        <button class="btn waves-effect waves-light col s12 blue accent-4" name="action" type="submit">\n                            Send <i class="material-icons right">send</i>\n                        </button>\n                    </div>\n                </div>\n            </form>\n        ')):(n='<li class="collection-item">Comments are disabled</li>',"");var a=e.liked?"favorite":"favorite_border",o=e.liked?"undo_like":"like";return'\n        <div class="col s12">\n            <div class="card">\n                <div class="card-image"><img id="post_image" class="materialboxed" data-caption="'.concat(e.caption,'" src="').concat(e.img_url,'"></div>\n                <div class="card-content">\n                    <p>\n                        <span id="post_owner"><a href="/u/').concat(e.username,'">').concat(e.username,"</a></span> ").concat(e.caption,'\n                    </p>\n                </div>\n                <div class="card-action">\n                    <div class="row likes">\n                        <a href="/posts/actions/').concat(CSRFtoken,"/").concat(o,"/").concat(e.id,'" class="mr-6"><i class="material-icons blue-icon">').concat(a,"</i></a> ").concat(e.likes,' likes\n                    </div>\n                    <div class="row mb-0">\n                        <h6>Comments:</h6>\n                        <ul class="collection">\n                            ').concat(n,"\n                        </ul>\n                            ").concat(t,"\n                    </div>\n                </div>\n            </div>\n        </div>\n    ")}function feed_render_comments(e){var n=[],t=!0,a=!1,o=void 0;try{for(var s,c=e[Symbol.iterator]();!(t=(s=c.next()).done);t=!0)comment=s.value,n.push(render_comment(comment))}catch(e){a=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(a)throw o}}return n.join("")}function feed_render_comment(e){return'\n        <li class="collection-item avatar">\n            <img src="'.concat(e.profile_picture,'" onerror="this.src=\'https://github.com/identicons/').concat(e.username,'.png\'" class="circle" />\n            <span class="title"><a href="/u/').concat(e.username,'" class="blue-text">').concat(e.username,'</a></span>\n            <p class="truncate">').concat(e.body,"</p>\n        </li>\n    ")}function feed_render_messages(e){
// setInterval(feed_check_messages(), 3000);
if(!e.success)return console.log("no posts"),!1;// localStorage.setItem('messages', data);
var n=[],t=!0,a=!1,o=void 0;try{for(var s,c=e.messages[Symbol.iterator]();!(t=(s=c.next()).done);t=!0)message=s.value,n.push(feed_render_message(message))}catch(e){a=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(a)throw o}}return n.join("")}function feed_check_messages(){request("GET","https://instakilo.lucacastelnuovo.nl/messages/actions/".concat(CSRFtoken),function(e){e!==localStorage.getItem("messages")&&M.toast({html:'<span>You have new messages!</span><button class="btn-flat toast-action blue-text accent-4" onclick="location.reload()">Load messages</button>',displayLength:864e5})})}function feed_render_message(){return'\n        <li class="collection-item avatar">\n            <i class="material-icons circle">account_circle</i> <span class="title">FirstName Last Name</span>\n            <p class="truncate">Layers, background, shot, concept â€“ good!</p><a class="secondary-content" href="#!"><i class="material-icons blue-icon">message</i></a>\n        </li>\n    '}
// @codekit-prepend "init.js";
// @codekit-prepend "request.js";
// @codekit-prepend "feed_posts.js";
// @codekit-prepend "feed_messages.js";
"undefined"!=typeof auto_init&&auto_init&&document.addEventListener("DOMContentLoaded",function(){materialize_init()});
//# sourceMappingURL=app.js.map