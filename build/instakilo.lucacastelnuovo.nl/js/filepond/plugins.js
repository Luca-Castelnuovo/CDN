"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(void 0).FilePondPluginImageCrop=t()}(0,function(){var d=function(e){return/^image/.test(e.type)},o="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.isFile,a=n.getNumericAspectRatioFromString,u=function(e,t){return!(!d(e.file)||!t("GET_ALLOW_IMAGE_CROP"))},l=function(e){return"object"===(void 0===e?"undefined":o(e))},f=function(e){return"number"==typeof e},c=function(e,t){return e.setMetadata("crop",Object.assign({},e.getMetadata("crop"),t))};return t("DID_CREATE_ITEM",function(o,e){var r=e.query;o.extend("setImageCrop",function(e){if(u(o,r)&&l(center))return o.setMetadata("crop",e),e}),o.extend("setImageCropCenter",function(e){if(u(o,r)&&l(e))return c(o,{center:e})}),o.extend("setImageCropZoom",function(e){if(u(o,r)&&f(e))return c(o,{zoom:Math.max(1,e)})}),o.extend("setImageCropRotation",function(e){if(u(o,r)&&f(e))return c(o,{rotation:e})}),o.extend("setImageCropFlip",function(e){if(u(o,r)&&l(e))return c(o,{flip:e})}),o.extend("setImageCropAspectRatio",function(e){if(u(o,r)&&void 0!==e){var t=o.getMetadata("crop"),n=a(e),i={center:{x:.5,y:.5},flip:t?Object.assign({},t.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:n};return o.setMetadata("crop",i),i}})}),t("DID_LOAD_ITEM",function(i,e){var o=e.query;return new Promise(function(e){var t=i.file;if(!r(t)||!d(t)||!o("GET_ALLOW_IMAGE_CROP"))return e(i);if(i.getMetadata("crop"))return e(i);var n=o("GET_IMAGE_CROP_ASPECT_RATIO");i.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:n?a(n):null}),e(i)})}),{options:{allowImageCrop:[!0,i.BOOLEAN],imageCropAspectRatio:[null,i.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(void 0).FilePondPluginImageExifOrientation=t()}(0,function(){var f=function(e,t,n){var i=2<arguments.length&&void 0!==n&&n;return e.getUint16(t,i)},c=function(e,t,n){var i=2<arguments.length&&void 0!==n&&n;return e.getUint32(t,i)},e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.isFile;return t("DID_LOAD_ITEM",function(i,e){var o=e.query;return new Promise(function(t){var n,e=i.file;if(!r(e)||!/^image\/jpeg/.test(e.type)||!o("GET_ALLOW_IMAGE_EXIF_ORIENTATION"))return t(i);(n=e,new Promise(function(l){var e=new FileReader;e.onload=function(e){var t=new DataView(e.target.result);if(65496===f(t,0)){for(var n=t.byteLength,i=2;i<n;){var o=f(t,i);if(i+=2,65505===o){if(1165519206!==c(t,i+=2))break;var r=18761===f(t,i+=6);i+=c(t,i+4,r);var a=f(t,i,r);i+=2;for(var u=0;u<a;u++)if(274===f(t,i+12*u,r))return void l(f(t,i+12*u+8,r))}else{if(65280!=(65280&o))break;i+=f(t,i)}}l(-1)}else l(-1)},e.readAsArrayBuffer(n.slice(0,65536))})).then(function(e){i.setMetadata("exif",{orientation:e}),t(i)})})}),{options:{allowImageExifOrientation:[!0,i.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(void 0).FilePondPluginFileValidateType=t()}(0,function(){var e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,a=n.isString,l=n.replaceInString,u=n.guesstimateMimeType,f=n.getExtensionFromFilename,c=n.getFilenameFromURL,d=function(e,n){return e.some(function(e){return/\*$/.test(e)?(t=e,(/^[^/]+/.exec(n)||[]).pop()===t.slice(0,-2)):e===n;var t})},s=function(e,i,o){if(0===i.length)return!0;var r=function(e){var t="";if(a(e)){var n=c(e),i=f(n);i&&(t=u(i))}else t=e.type;return t}(e);return o?new Promise(function(t,n){o(e,r).then(function(e){d(i,e)?t():n()}).catch(n)}):d(i,r)};return t("SET_ATTRIBUTE_TO_OPTION_MAP",function(e){return Object.assign(e,{accept:"acceptedFileTypes"})}),t("ALLOW_HOPPER_ITEM",function(e,t){var n=t.query;return!n("GET_ALLOW_FILE_TYPE_VALIDATION")||s(e,n("GET_ACCEPTED_FILE_TYPES"))}),t("LOAD_FILE",function(a,e){var u=e.query;return new Promise(function(e,n){if(u("GET_ALLOW_FILE_TYPE_VALIDATION")){var i=u("GET_ACCEPTED_FILE_TYPES"),t=u("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),o=s(a,i,t),r=function(){var t,e=i.map((t=u("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"),function(e){return null!==t[e]&&(t[e]||e)})).filter(function(e){return!1!==e});n({status:{main:u("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:l(u("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:e.join(", "),allButLastType:e.slice(0,-1).join(", "),lastType:e[e.length-1]})}})};if("boolean"==typeof o)return o?e(a):r();o.then(function(){e(a)}).catch(r)}else e(a)})}),{options:{allowFileTypeValidation:[!0,i.BOOLEAN],acceptedFileTypes:[[],i.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",i.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",i.STRING],fileValidateTypeLabelExpectedTypesMap:[{},i.OBJECT],fileValidateTypeDetectType:[null,i.FUNCTION]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(void 0).FilePondPluginFileValidateSize=t()}(0,function(){var e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,u=n.replaceInString,l=n.toNaturalFileSize;return t("ALLOW_HOPPER_ITEM",function(e,t){var n=t.query;if(!n("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;var i=n("GET_MAX_FILE_SIZE");if(null!==i&&e.size>=i)return!1;var o=n("GET_MIN_FILE_SIZE");return!(null!==o&&e.size<=o)}),t("LOAD_FILE",function(r,e){var a=e.query;return new Promise(function(e,t){if(a("GET_ALLOW_FILE_SIZE_VALIDATION")){var n=a("GET_MAX_FILE_SIZE");if(null!==n&&r.size>=n)t({status:{main:a("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:u(a("GET_LABEL_MAX_FILE_SIZE"),{filesize:l(n)})}});else{var i=a("GET_MIN_FILE_SIZE");if(null!==i&&r.size<=i)t({status:{main:a("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:u(a("GET_LABEL_MIN_FILE_SIZE"),{filesize:l(i)})}});else{var o=a("GET_MAX_TOTAL_FILE_SIZE");if(null!==o&&o<a("GET_ACTIVE_ITEMS").reduce(function(e,t){return e+t.fileSize},0))return void t({status:{main:a("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:u(a("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:l(o)})}});e(r)}}}else e(r)})}),{options:{allowFileSizeValidation:[!0,i.BOOLEAN],maxFileSize:[null,i.INT],minFileSize:[null,i.INT],maxTotalFileSize:[null,i.INT],labelMinFileSizeExceeded:["File is too small",i.STRING],labelMinFileSize:["Minimum file size is {filesize}",i.STRING],labelMaxFileSizeExceeded:["File is too large",i.STRING],labelMaxFileSize:["Maximum file size is {filesize}",i.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",i.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",i.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(void 0).FilePondPluginImageTransform=t()}(0,function(){var T=function(e,t){return{x:e,y:t}},a=function(e,t){return T(e.x-t.x,e.y-t.y)},v=function(e,t){return Math.sqrt((o=a(n=e,i=t),r=a(n,i),o.x*r.x+o.y*r.y));var n,i,o,r},I=function(e,t){var n=e,i=t,o=1.5707963267948966-t,r=Math.sin(1.5707963267948966),a=Math.sin(i),u=Math.sin(o),l=Math.cos(o),f=n/r;return T(l*(f*a),l*(f*u))},P=function(e,t,n,i){var o,r,a,u,l,f,c,d,s,p=2<arguments.length&&void 0!==n?n:0,m=3<arguments.length&&void 0!==i?i:{x:.5,y:.5},y=.5<m.x?1-m.x:m.x,h=.5<m.y?1-m.y:m.y,_=2*y*e.width,E=2*h*e.height,g=(r=p,a=(o=t).width,u=o.height,l=I(a,r),f=I(u,r),c=T(o.x+Math.abs(l.x),o.y-Math.abs(l.y)),d=T(o.x+o.width+Math.abs(f.y),o.y+Math.abs(f.x)),s=T(o.x-Math.abs(f.y),o.y+o.height-Math.abs(f.x)),{width:v(c,d),height:v(c,s)});return Math.max(g.width/_,g.height/E)},G=function(e,t){var n=e.width,i=n*t;return i>e.height&&(n=(i=e.height)/t),{x:.5*(e.width-n),y:.5*(e.height-i),width:n,height:i}},y={1:function(){return[1,0,0,1,0,0]},2:function(e){return[-1,0,0,1,e,0]},3:function(e,t){return[-1,0,0,-1,e,t]},4:function(e,t){return[1,0,0,-1,0,t]},5:function(){return[0,1,1,0,0,0]},6:function(e,t){return[0,1,-1,0,t,0]},7:function(e,t){return[0,-1,-1,0,t,e]},8:function(e){return[0,-1,1,0,0,e]}},h=function(e){return e&&(e.horizontal||e.vertical)},s=function(e,t,n){n||(n={});var i=function(e,t,n){if(!t&&!h(n))return e.width=e.naturalWidth,e.height=e.naturalHeight,e;var i=document.createElement("canvas"),o=e.naturalWidth,r=e.naturalHeight,a=5<=t&&t<=8;i.height=a?(i.width=r,o):(i.width=o,r);var u,l,f,c=i.getContext("2d");if(t&&c.transform.apply(c,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}((u=o,l=r,-1===(f=t)&&(f=1),y[f](u,l)))),h(n)){var d=[1,0,0,1,0,0];(!a&&n.horizontal||a&n.vertical)&&(d[0]=-1,d[4]=o),(!a&&n.vertical||a&&n.horizontal)&&(d[3]=-1,d[5]=r),c.transform.apply(c,d)}return c.drawImage(e,0,0,o,r),i}(e,t,n.flip),o={width:i.width,height:i.height},r=document.createElement("canvas"),a=n.aspectRatio||o.height/o.width,u=function(e,t,n){var i=2<arguments.length&&void 0!==n?n:1,o=e.height/e.width,r=t,a=1,u=o;r<u&&(a=(u=r)/o);var l=Math.max(1/a,r/u),f=e.width/(i*a*l),c=f*t;return{width:Math.round(f),height:Math.round(c)}}(o,a,n.zoom);r.width=u.width,r.height=u.height;var l={x:.5*r.width,y:.5*r.height},f=l.x-o.width*(n.center?n.center.x:.5),c=l.y-o.height*(n.center?n.center.y:.5),d={x:0,y:0,width:r.width,height:r.height,center:l},s=P(o,G(d,a),n.rotation,n.center),p=(n.zoom||1)*s,m=r.getContext("2d");return m.translate(l.x,l.y),m.rotate(n.rotation||0),m.scale(p,p),m.drawImage(i,f-l.x,c-l.y,o.width,o.height),m.getImageData(0,0,r.width,r.height)},p=function(){var o={resize:function(e,t){var n=t.mode,i=t.upscale,o=t.size,r=o.width,a=o.height;if(null===r?r=a:null===a&&(a=r),"force"!==n){var u=r/e.width,l=a/e.height,f=1;if("cover"===n?f=Math.max(u,l):"contain"===n&&(f=Math.min(u,l)),1<f&&!1===i)return e;r=e.width*f,a=e.height*f}for(var c=e.width,d=e.height,s=Math.round(r),p=Math.round(a),m=e.data,y=new Uint8ClampedArray(s*p*4),h=c/s,_=d/p,E=Math.ceil(h/2),g=Math.ceil(_/2),T=0;T<p;T++)for(var v=0;v<s;v++){for(var I=4*(v+T*s),A=0,b=0,M=0,w=gx_g=gx_b=gx_a=0,L=(T+.5)*_,S=Math.floor(T*_);S<(T+1)*_;S++)for(var x=Math.abs(L-(S+.5))/g,F=(v+.5)*h,O=x*x,R=Math.floor(v*h);R<(v+1)*h;R++){var P=Math.abs(F-(R+.5))/E,G=Math.sqrt(O+P*P);-1<=G&&G<=1&&0<(A=2*G*G*G-3*G*G+1)&&(P=4*(R+S*c),gx_a+=A*m[P+3],M+=A,m[P+3]<255&&(A=A*m[P+3]/250),w+=A*m[P],gx_g+=A*m[P+1],gx_b+=A*m[P+2],b+=A)}y[I]=w/b,y[I+1]=gx_g/b,y[I+2]=gx_b/b,y[I+3]=gx_a/M}return{data:y,width:s,height:p}}};self.onmessage=function(t){var e,n,i;e=t.data.message,function(e){self.postMessage({id:t.data.id,message:e},[e.data.buffer])}((n=e.transforms,i=e.imageData,n.forEach(function(e){var t=o[e.type];t&&(i=t(i,e.data))}),i))}},m=function(e,t){if(1165519206===e.getUint32(t+4,!1)){t+=4;var n=18761===e.getUint16(t+=6,!1);t+=e.getUint32(t+4,n);var i=e.getUint16(t,n);t+=2;for(var o=0;o<i;o++)if(274===e.getUint16(t+12*o,n))return e.setUint16(t+12*o+8,1,n),!0;return!1}},d=function(e){var n=e.loadImage,f=e.createWorker,l=e.getFilenameWithoutExtension,c=e.getFileFromBlob,d=function(a,e,u){return new Promise(function(r){var n,i,o=function(e){var t,n,i,o=c(e,(t=a.name,n="image/jpeg"===(i=e.type)||"image/png"===i?i:"image/jpeg",l(t)+"."+("image/jpeg"===n?"jpg":n.split("/")[1])));r(o)};(n=e,i=u,new Promise(function(e){var t=document.createElement("canvas");t.width=n.width,t.height=n.height,t.getContext("2d").putImageData(n,0,0),t.toBlob(e,i.type,i.quality)})).then(function(t){var n;u.stripImageHead?o(t):(n=a,new Promise(function(e){var t=new FileReader;t.onload=function(){return e(function(e){var t=new DataView(e);if(65496!==t.getUint16(0))return null;for(var n=2,i=void 0,o=void 0,r=!1;n<t.byteLength&&(i=t.getUint16(n,!1),o=t.getUint16(n+2,!1)+2,65504<=i&&i<=65519||65534===i)&&(r||(r=m(t,n)),!(n+o>t.byteLength));)n+=o;return e.slice(0,n)}(t.result)||null)},t.readAsArrayBuffer(n.slice(0,262144))})).then(function(e){null!==e&&(t=new Blob([e,t.slice(20)],{type:t.type})),o(t)})}).catch(function(e){console.error(e)})})};return function(r,a,u,l){return new Promise(function(o){var t=URL.createObjectURL(a);n(t).then(function(e){URL.revokeObjectURL(t),function(e){if(r.archived)return o(a);var t=(u.find(function(e){return"crop"===e.type})||{}).data,n=s(e,(r.getMetadata("exif")||{}).orientation||-1,t);if(!u.length)return d(a,n,l).then(o);var i=f(p);i.post({transforms:u,imageData:n},function(e){if(r.archived)return o(a);d(a,function(t){var n=void 0;try{n=new ImageData(t.width,t.height)}catch(e){n=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return n.data.set(t.data),n}(e),l).then(o),i.terminate()},[n.data.buffer])}(e)})})}};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(o,r,a){var u=this;setTimeout(function(){for(var e=u.toDataURL(r,a).split(",")[1],t=atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);o(new Blob([i],{type:r||"image/png"}))})}});var e=function(e){var t,O,R,n=e.addFilter,i=e.utils,o=i.Type,p=i.forin,r=i.loadImage,a=i.getFileFromBlob,u=i.getFilenameWithoutExtension,l=i.createWorker,f=i.createBlob,c=i.renameFile,m=i.isFile,y=["crop","resize"],h=d({loadImage:r,createWorker:l,getFileFromBlob:a,getFilenameWithoutExtension:u}),_=(O=(t={createBlob:f,renameFile:c}).createBlob,R=t.renameFile,function(x,F,e){return new Promise(function(w){var L=(e.find(function(e){return"crop"===e.type})||{}).data;if(!L)return w(F);var S=new FileReader;S.onloadend=function(){if(x.archived)return w(F);var e=S.result,t=document.createElement("div");t.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;",t.innerHTML=e;var n=t.querySelector("svg");document.body.appendChild(t);var i=n.getBBox();t.parentNode.removeChild(t);var o=t.querySelector("title"),r=n.getAttribute("viewBox")||"",a=n.getAttribute("width")||"",u=n.getAttribute("height")||"",l=parseFloat(a)||null,f=parseFloat(u)||null,c=(a.match(/[a-z]+/)||[])[0]||"",d=(u.match(/[a-z]+/)||[])[0]||"",s=r.split(" ").map(parseFloat),p=s.length?{x:s[0],y:s[1],width:s[2],height:s[3]}:i,m=null!=l?l:p.width,y=null!=f?f:p.height;n.style.overflow="visible",n.setAttribute("width",m),n.setAttribute("height",y);var h=L.aspectRatio||y/m,_=m,E=_*h,g=P({width:m,height:y},G({width:_,height:E},h),L.rotation,L.center),T=L.zoom*g,v=.5*_,I=.5*E,A=["rotate("+L.rotation*(180/Math.PI)+" "+v+" "+I+")","translate("+v+" "+I+")","scale("+T+")","translate("+-v+" "+-I+")","translate("+(v-m*L.center.x)+" "+(I-y*L.center.y)+")"],b=["scale("+(L.flip.horizontal?-1:1)+" "+(L.flip.vertical?-1:1)+")","translate("+(L.flip.horizontal?-m:0)+" "+(L.flip.vertical?-y:0)+")"],M='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="'+_+c+'" height="'+E+d+'" \nviewBox="0 0 '+_+" "+E+'" \npreserveAspectRatio="xMinYMin"\nxmlns="http://www.w3.org/2000/svg">\n\x3c!-- Generator: FilePond Image Transform Plugin - https://pqina.nl/filepond --\x3e\n<title>'+(o?o.textContent:F.name)+'</title>\n<desc>Cropped with FilePond.</desc>\n<g transform="'+A.join(" ")+'">\n<g transform="'+b.join(" ")+'">\n'+n.outerHTML+"\n</g>\n</g>\n</svg>";w(R(O(M,"image/svg+xml"),F.name))},S.readAsText(F)})});return n("SHOULD_PREPARE_OUTPUT",function(e,t){var n=t.query;return new Promise(function(e){e(!n("IS_ASYNC"))})}),n("PREPARE_OUTPUT",function(c,e){var d=e.query,s=e.item;return new Promise(function(t){if(!m(c)||!/^image/.test(c.type)||!d("GET_ALLOW_IMAGE_TRANSFORM")||s.archived)return t(c);var n=[];d("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")&&n.push(function(){return new Promise(function(e){e({name:d("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),file:c})})}),d("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")&&n.push(function(e,n,i){return new Promise(function(t){e(n,i).then(function(e){return t({name:d("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),file:e})})})});var e=d("GET_IMAGE_TRANSFORM_VARIANTS")||{};p(e,function(o,e){var i,r=(i=e,function(e,t,n){return e(t,i?i(n):n)});n.push(function(e,n,i){return new Promise(function(t){r(e,n,i).then(function(e){return t({name:o,file:e})})})})});var i=d("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY"),u=d("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE"),o=null===i?null:i/100,r=d("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE"),l=d("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS")||y;s.setMetadata("output",{quality:o,type:r,client:l},!0);var a=function(r,a){return new Promise(function(e){var n=[];p(a,function(e,t){l.includes(e)&&n.push({type:e,data:t})}),n.sort(function(e,t){var n=y.indexOf(e.type),i=y.indexOf(t.type);return n<i?-1:i<n?1:0});var t=a.output||{},i=t.type,o=t.quality;return 0!==n.length||null!==o&&(null===o||"optional"!==u)||null!==i&&i!==r.type?/svg/.test(r.type)&&null===i?_(s,r,n).then(e):void h(s,r,n,{type:i||r.type,quality:o,stripImageHead:d("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")}).then(e):e(r)})},f=n.map(function(e){return e(a,c,s.getMetadata())});Promise.all(f).then(function(e){t(1===e.length&&null===e[0].name?e[0].file:e)})})}),{options:{allowImageTransform:[!0,o.BOOLEAN],imageTransformOutputMimeType:[null,o.STRING],imageTransformOutputQuality:[null,o.INT],imageTransformOutputStripImageHead:[!0,o.BOOLEAN],imageTransformClientTransforms:[null,o.ARRAY],imageTransformOutputQualityMode:["always",o.STRING],imageTransformVariants:[null,o.OBJECT],imageTransformVariantsIncludeDefault:[!0,o.BOOLEAN],imageTransformVariantsDefaultName:[null,o.STRING],imageTransformVariantsIncludeOriginal:[!1,o.BOOLEAN],imageTransformVariantsOriginalName:["original_",o.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e}),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(void 0).FilePondPluginImageCrop=t()}(0,function(){var d=function(e){return/^image/.test(e.type)},o="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},e=function(e){var t=e.addFilter,n=e.utils,i=n.Type,r=n.isFile,a=n.getNumericAspectRatioFromString,u=function(e,t){return!(!d(e.file)||!t("GET_ALLOW_IMAGE_CROP"))},l=function(e){return"object"===(void 0===e?"undefined":o(e))},f=function(e){return"number"==typeof e},c=function(e,t){return e.setMetadata("crop",Object.assign({},e.getMetadata("crop"),t))};return t("DID_CREATE_ITEM",function(o,e){var r=e.query;o.extend("setImageCrop",function(e){if(u(o,r)&&l(center))return o.setMetadata("crop",e),e}),o.extend("setImageCropCenter",function(e){if(u(o,r)&&l(e))return c(o,{center:e})}),o.extend("setImageCropZoom",function(e){if(u(o,r)&&f(e))return c(o,{zoom:Math.max(1,e)})}),o.extend("setImageCropRotation",function(e){if(u(o,r)&&f(e))return c(o,{rotation:e})}),o.extend("setImageCropFlip",function(e){if(u(o,r)&&l(e))return c(o,{flip:e})}),o.extend("setImageCropAspectRatio",function(e){if(u(o,r)&&void 0!==e){var t=o.getMetadata("crop"),n=a(e),i={center:{x:.5,y:.5},flip:t?Object.assign({},t.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:n};return o.setMetadata("crop",i),i}})}),t("DID_LOAD_ITEM",function(i,e){var o=e.query;return new Promise(function(e){var t=i.file;if(!r(t)||!d(t)||!o("GET_ALLOW_IMAGE_CROP"))return e(i);if(i.getMetadata("crop"))return e(i);var n=o("GET_IMAGE_CROP_ASPECT_RATIO");i.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:n?a(n):null}),e(i)})}),{options:{allowImageCrop:[!0,i.BOOLEAN],imageCropAspectRatio:[null,i.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e});
//# sourceMappingURL=plugins.js.map